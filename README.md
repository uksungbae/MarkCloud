# MarkCloud

마크클라우드 백엔드 개발자 과제 - 상표 검색 API 서비스

## 1. API 사용법 및 실행 방법

### 환경 설정

```bash
# 가상환경 생성 및 활성화
python -m venv venv

# macOS/Linux
source venv/bin/activate

# Windows
# venv\Scripts\activate

# 필요한 패키지 설치
pip install -r requirements.txt


# 환경 변수 설정 (.env 파일 생성)

```

### 서버 실행

```bash
uvicorn main:app --reload
```

### API 엔드포인트

- **상표 필터링 검색**: `/products/filter` (GET)
- **상표 상세 조회**: `/products/{product_id}` (GET)
- **유사 키워드 검색**: `/products/search/similar` (GET)
- **상표 상태별 카운트**: `/products/status/counts` (GET)

### API 문서

- Swagger UI: `/docs`
- ReDoc: `/redoc`

## 2. 구현된 기능 설명

### 상표 데이터 조회
- **필터링 검색**: 전체 필드를 기준으로 필터링
- **ID 기반 조회**: 특정 상표 ID로 상세 정보 조회

### 유사 키워드 검색
- **유사 키워드 검색**: MongoDB Atlas Search를 활용한 퍼지 검색 구현
  - 오타 허용 (최대 2글자까지 편집 거리 허용)
  - 첫 글자 일치 요구 (prefixLength=1)
  - 관련성 점수 기반 정렬
  - 최소 점수 필터링으로 품질 관리

### 데이터 집계
- **상태별 카운트**: 상표 등록 상태별 개수 집계 API

## 3. 기술적 의사결정에 대한 설명

### 기술 스택 선택
- **FastAPI**: 비동기 처리와 자동 문서화 기능을 활용하기 위해 선택
- **MongoDB**: 상표 데이터의 유연한 스키마와 Atlas Search 기능을 활용하기 위해 선택
- **Motor**: 비동기 MongoDB 드라이버로 FastAPI와의 호환성 확보

### 아키텍처 설계
- **계층 분리**: API 라우트, CRUD 로직, 데이터 모델을 분리
- **비동기 처리**: 모든 데이터베이스 I/O 작업을 비동기로 구현하여 성능 최적화
- **Pydantic 모델**: 요청 및 응답 데이터 검증을 위한 스키마 정의

### 유사 키워드 검색 구현
- **Atlas Search**: 텍스트 검색을 위한 MongoDB Atlas Search 인덱스 활용
- **복합 검색 전략**: 여러 검색 조건을 조합하여 정확도와 다양성 확보
- **가중치 부여**: 검색 조건별 중요도에 따라 가중치 차등 적용

## 4. 문제 해결 과정에서의 고민 및 개선점

### 문제 해결 과정에서 고민했던 점
- **MongoDB 선정**: json파일로 읽어서 메모리 검색을 하면 데이터가 늘어날수록 메모리 부족 문제가 발생할 수 있다는 점을 고려해 DB도입을 선택했고, 필드 타입 중 리스트 형식이 있어 RDB보다는 유연성이 좋은 NoSQL의 MongoDB를 선정했습니다.

- **검색 기능 구현 방식**: 초기에는 MongoDB의 기본 쿼리 기능을 사용하여 검색을 구현했으나, 오타를 허용하는 유사 키워드 검색을 위해서는 추가 기능이 필요했습니다. MongoDB Atlas Search를 도입하여 퍼지 검색, 가중치 부여 등의기능을 활용하기로 결정했습니다. 

- **기능별 Branch**: 구현해야 할 Task를 나눠 Github Issue를 생성하고, 각 기능별로 Branch를 생성하여 개발했습니다. 개발은 초기세팅, 일반API(필터링 검색, 특정 상품 상세 조회, 등록 상태별 카운트 조회) 구현, 유사 키워드 검색 API 구현, 리팩토링 순으로 진행했습니다. 완료된 Task는 이후 Main branch로 merge했습니다.

### 개선하고 싶은 부분(대량 데이터 처리 중점으로..)
- **검색 엔진 도입**: 대량 데이터에서도 빠른 검색을 위해 Elasticsearch 도입
- **캐싱 시스템**: 자주 요청되는 검색 결과에 대한 캐싱 도입
- **페이지네이션**: 페이지네이션으로 대용량 데이터 처리 효율화
- **Scale Out**: 트래픽이 늘어나면, 서버를 수평 확장하는 것을 고려

### 확장 가능성
- **사용자 맞춤형 추천**: 사용자 검색 패턴 기반 상표 추천 시스템
